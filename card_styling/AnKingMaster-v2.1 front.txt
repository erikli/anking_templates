<div id="content"><!-- START #content -->

{{edit:cloze:Text}}


<!-- ##############  Text-to-speech  ##############
replace the arrows/dashes from the statement below with double brackets-->

<!--tts en_US voices=Apple_Samantha speed=1.4:cloze:Text-->



<div class="timer" id="s2"></div>
<script>
    //############## TIMER CONFIGURATION START ##############
    //Set Timer Length
    var minutes = 0
    var seconds = 9
    //############## TIMER CONFIGURATION END ##############
    
    function countdown( elementName, minutes, seconds )
    {
        var element, endTime, hours, mins, msLeft, time;
        function twoDigits( n )
        {
            return (n <= 9 ? "0" + n : n); 
        }
        function updateTimer()
        {
            msLeft = endTime - (+new Date);
    
    //USER CUSTOMIZATION- you can edit color and text of the 'time expired' readout under the element.innerHTML
            if ( msLeft < 1000 ) {
                element.innerHTML = "<span style='color:#CC5B5B'>!<br/>!<br/>!<br/>!<br/>!<br/>!</span>";
            } else {
                time = new Date( msLeft );
                hours = time.getUTCHours();
                mins = time.getUTCMinutes();
                element.innerHTML = (hours ? hours + ':' + twoDigits( mins ) : mins) + ':' + twoDigits( time.getUTCSeconds() );
                setTimeout( updateTimer, time.getUTCMilliseconds() + 500 );
            }
        }
        element = document.getElementById( elementName );
        endTime = (+new Date) + 1000 * (60*minutes + seconds) + 500;
        updateTimer();
    }
    countdown("s2", minutes, seconds ); //2nd value is the minute, 3rd is the seconds
</script>

<div id="pic"><a href="https://www.ankingmed.com">
        <img src="_AnKingRound.png" alt="The AnKing" style="height:50px;border:0;position:fixed;bottom:10px;right:10px;">
    </a></div>

<script>
    //DONT FADE BETWEEN CARDS
	qFade=0; if (typeof anki !== 'undefined') anki.qFade=qFade;
</script>
</div><!-- END #content -->

{{#Tags}}
    <div id="tags-container">{{clickable::Tags}}</div>
    <script>
        (function(){//anonymous function to avoid polluting global namespace
          var tagContainer = document.getElementById("tags-container");
          if(tagContainer && tagContainer.childElementCount == 0) {
            var tags = tagContainer.innerHTML.split(" ");
            var tag_tree = Array();
            var tag_tracker = Object();
            // tree is [{'name':'tagName','sub':[]}] where `sub` contains subtrees
            // tracker is ['tagName':treeObj]

            var SEPARATOR = "::";// TODO: configurable SEPARATOR
            for( t of tags ){
              components = t.split(SEPARATOR);
              for(const [idx, c] of components.entries() ){
                partial_tag = components.slice(0, idx + 1).join(SEPARATOR);
                if(!tag_tracker.hasOwnProperty(partial_tag)){
                  treeObj = {'name':partial_tag,'sub':Array()}
                  tag_tracker[partial_tag] = treeObj
                  if(idx == 0){
                    tag_tree.push(treeObj)
                  }
                  else{
                    parent_tag = components.slice(0,idx).join(SEPARATOR);
                    parent = tag_tracker[parent_tag];
                    parent['sub'].push(treeObj)
                  }
                }
              }
            }

            function _kbd_tag_recursive(tag_tree){
              return tag_tree.reduce(function(tag_tree_html, tagObj){
                var tag = tagObj['name'];
                //uses SEPARATOR bound to outside closure
                var short_tag = tagObj['name'].split(SEPARATOR);
                short_tag = short_tag[short_tag.length-1];

                return `${tag_tree_html}<kbd data-ankitag="${tag}">${short_tag}${_kbd_tag_recursive(tagObj['sub'])}</kbd>`
              },"");
            }

            tagContainer.innerHTML = _kbd_tag_recursive(tag_tree)
          }
          if (tagContainer.innerHTML.indexOf("Missed") != -1) {
            tagContainer.style.backgroundColor = "rgba(251,11,11,.2)";
          } else {
            tagContainer.style.display = "none";
          }
        })();
    </script>
{{/Tags}}
